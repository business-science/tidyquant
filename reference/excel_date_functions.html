<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Excel Date and Time Functions — excel_date_functions • tidyquant</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Excel Date and Time Functions — excel_date_functions"><meta name="description" content="50+ date and time functions familiar to users coming from an Excel Background.
The main benefits are:
Integration of the amazing lubridate package for handling dates and times
Integration of Holidays from timeDate and Business Calendars
New Date Math and Date Sequence Functions that factor in Business Calendars (e.g. EOMONTH(), NET_WORKDAYS())


These functions are designed to help users coming from an Excel background.
Most functions replicate the behavior of Excel:
Names in most cases match Excel function names
Functionality replicates Excel
By default, missing values are ignored (same as in Excel)

"><meta property="og:description" content="50+ date and time functions familiar to users coming from an Excel Background.
The main benefits are:
Integration of the amazing lubridate package for handling dates and times
Integration of Holidays from timeDate and Business Calendars
New Date Math and Date Sequence Functions that factor in Business Calendars (e.g. EOMONTH(), NET_WORKDAYS())


These functions are designed to help users coming from an Excel background.
Most functions replicate the behavior of Excel:
Names in most cases match Excel function names
Functionality replicates Excel
By default, missing values are ignored (same as in Excel)

"><meta property="og:image" content="https://business-science.github.io/tidyquant/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-20GDZ5LL77"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-20GDZ5LL77');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyquant</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../articles/TQ00-introduction-to-tidyquant.html">Start</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><h6 class="dropdown-header" data-toc-skip>Getting Started</h6></li>
    <li><a class="dropdown-item" href="../articles/TQ00-introduction-to-tidyquant.html">Introduction to Tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ01-core-functions-in-tidyquant.html">Core Functions in Tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ02-quant-integrations-in-tidyquant.html">Quant Integrations in Tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ03-scaling-and-modeling-with-tidyquant.html">Scaling and Modeling with Tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ04-charting-with-tidyquant.html">Charting with Tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ05-performance-analysis-with-tidyquant.html">Performance Analysis with Tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ06-excel-in-r.html">Excel Integrations in R</a></li>
  </ul></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-api" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">API</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-api"><li><a class="dropdown-item" href="../reference/index.html">API Functions</a></li>
    <li><a class="dropdown-item" href="../news/index.html">News</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/business-science/tidyquant"><span class="fa fab fa-github"></span></a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/business-science/tidyquant" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Excel Date and Time Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/business-science/tidyquant/blob/master/R/excel-date-functions.R" class="external-link"><code>R/excel-date-functions.R</code></a></small>
      <div class="d-none name"><code>excel_date_functions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>50+ date and time functions familiar to users coming from an <strong>Excel Background.</strong>
The main benefits are:</p><ol><li><p>Integration of the amazing <code>lubridate</code> package for handling dates and times</p></li>
<li><p>Integration of Holidays from <code>timeDate</code> and Business Calendars</p></li>
<li><p>New Date Math and Date Sequence Functions that factor in Business Calendars (e.g. <code>EOMONTH()</code>, <code>NET_WORKDAYS()</code>)</p></li>
</ol><p>These functions are designed to help users coming from an <strong>Excel background</strong>.
Most functions replicate the behavior of Excel:</p><ul><li><p>Names in most cases match Excel function names</p></li>
<li><p>Functionality replicates Excel</p></li>
<li><p>By default, missing values are ignored (same as in Excel)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">AS_DATE</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">AS_DATETIME</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DATE</span><span class="op">(</span><span class="va">year</span>, <span class="va">month</span>, <span class="va">day</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DATEVALUE</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YMD</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MDY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DMY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YMD_HMS</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MDY_HMS</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DMY_HMS</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YMD_HM</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MDY_HM</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DMY_HM</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YMD_H</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MDY_H</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DMY_H</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">WEEKDAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, label <span class="op">=</span> <span class="cn">FALSE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">WDAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, label <span class="op">=</span> <span class="cn">FALSE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DOW</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, label <span class="op">=</span> <span class="cn">FALSE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MONTHDAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MDAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DOM</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">QUARTERDAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">QDAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">WEEKNUM</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">WEEK</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">WEEKNUM_ISO</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MONTH</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, label <span class="op">=</span> <span class="cn">FALSE</span>, abbr <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">QUARTER</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, include_year <span class="op">=</span> <span class="cn">FALSE</span>, fiscal_start <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YEAR</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YEAR_ISO</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DATE_TO_NUMERIC</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DATE_TO_DECIMAL</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">SECOND</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">MINUTE</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">HOUR</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">NOW</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">TODAY</span><span class="op">(</span><span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">EOMONTH</span><span class="op">(</span><span class="va">start_date</span>, months <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">EDATE</span><span class="op">(</span><span class="va">start_date</span>, months <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">NET_WORKDAYS</span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span>, remove_weekends <span class="op">=</span> <span class="cn">TRUE</span>, holidays <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">COUNT_DAYS</span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">YEARFRAC</span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">DATE_SEQUENCE</span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">WORKDAY_SEQUENCE</span><span class="op">(</span><span class="va">start_date</span>, <span class="va">end_date</span>, remove_weekends <span class="op">=</span> <span class="cn">TRUE</span>, holidays <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">HOLIDAY_SEQUENCE</span><span class="op">(</span></span>
<span>  <span class="va">start_date</span>,</span>
<span>  <span class="va">end_date</span>,</span>
<span>  calendar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"NYSE"</span>, <span class="st">"LONDON"</span>, <span class="st">"NERC"</span>, <span class="st">"TSX"</span>, <span class="st">"ZURICH"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">HOLIDAY_TABLE</span><span class="op">(</span><span class="va">years</span>, pattern <span class="op">=</span> <span class="st">"."</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FLOOR_DATE</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FLOOR_DAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FLOOR_WEEK</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FLOOR_MONTH</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FLOOR_QUARTER</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FLOOR_YEAR</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CEILING_DATE</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CEILING_DAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CEILING_WEEK</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CEILING_MONTH</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CEILING_QUARTER</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">CEILING_YEAR</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ROUND_DATE</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span>, by <span class="op">=</span> <span class="st">"day"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ROUND_DAY</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ROUND_WEEK</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ROUND_MONTH</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ROUND_QUARTER</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ROUND_YEAR</span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>A vector of date or date-time objects</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Parameters passed to underlying <code>lubridate</code> functions.</p></dd>


<dt id="arg-year">year<a class="anchor" aria-label="anchor" href="#arg-year"></a></dt>
<dd><p>Used in <code>DATE()</code></p></dd>


<dt id="arg-month">month<a class="anchor" aria-label="anchor" href="#arg-month"></a></dt>
<dd><p>Used in <code>DATE()</code></p></dd>


<dt id="arg-day">day<a class="anchor" aria-label="anchor" href="#arg-day"></a></dt>
<dd><p>Used in <code>DATE()</code></p></dd>


<dt id="arg-label">label<a class="anchor" aria-label="anchor" href="#arg-label"></a></dt>
<dd><p>A logical used for <code>MONTH()</code> and <code>WEEKDAY()</code> Date Extractors to decide whether or not to return names
(as ordered factors) or numeric values.</p></dd>


<dt id="arg-abbr">abbr<a class="anchor" aria-label="anchor" href="#arg-abbr"></a></dt>
<dd><p>A logical used for <code>MONTH()</code> and <code>WEEKDAY()</code>. If <code>label = TRUE</code>, used to determine if
full names (e.g. Wednesday) or abbreviated names (e.g. Wed) should be returned.</p></dd>


<dt id="arg-include-year">include_year<a class="anchor" aria-label="anchor" href="#arg-include-year"></a></dt>
<dd><p>A logical value used in <code>QUARTER()</code>. Determines whether or not to return 2020 Q3 as <code>3</code> or <code>2020.3</code>.</p></dd>


<dt id="arg-fiscal-start">fiscal_start<a class="anchor" aria-label="anchor" href="#arg-fiscal-start"></a></dt>
<dd><p>A numeric value used in <code>QUARTER()</code>. Determines the fiscal-year starting quarter.</p></dd>


<dt id="arg-start-date">start_date<a class="anchor" aria-label="anchor" href="#arg-start-date"></a></dt>
<dd><p>Used in Date Math and Date Sequence operations. The starting date in the calculation.</p></dd>


<dt id="arg-months">months<a class="anchor" aria-label="anchor" href="#arg-months"></a></dt>
<dd><p>Used to offset months in <code>EOMONTH()</code> AND <code>EDATE()</code> Date Math calculations</p></dd>


<dt id="arg-end-date">end_date<a class="anchor" aria-label="anchor" href="#arg-end-date"></a></dt>
<dd><p>Used in Date Math and Date Sequence operations. The ending date in the calculation.</p></dd>


<dt id="arg-remove-weekends">remove_weekends<a class="anchor" aria-label="anchor" href="#arg-remove-weekends"></a></dt>
<dd><p>A logical value used in Date Sequence and Date Math calculations.
Indicates whether or not weekends should be removed from the calculation.</p></dd>


<dt id="arg-holidays">holidays<a class="anchor" aria-label="anchor" href="#arg-holidays"></a></dt>
<dd><p>A vector of dates corresponding to holidays that should be removed from the calculation.</p></dd>


<dt id="arg-by">by<a class="anchor" aria-label="anchor" href="#arg-by"></a></dt>
<dd><p>Used to determine the gap in Date Sequence calculations and value to round to in Date Collapsing operations.
Acceptable values are: A character string, containing one of <code>"day"</code>, <code>"week"</code>, <code>"month"</code>, <code>"quarter"</code> or <code>"year"</code>.</p></dd>


<dt id="arg-calendar">calendar<a class="anchor" aria-label="anchor" href="#arg-calendar"></a></dt>
<dd><p>The calendar to be used in Date Sequence calculations for Holidays from the <code>timeDate</code> package.
Acceptable values are: <code>"NYSE"</code>, <code>"LONDON"</code>, <code>"NERC"</code>, <code>"TSX"</code>, <code>"ZURICH"</code></p></dd>


<dt id="arg-years">years<a class="anchor" aria-label="anchor" href="#arg-years"></a></dt>
<dd><p>A numeric vector of years to return Holidays for in <code>HOLIDAY_TABLE()</code></p></dd>


<dt id="arg-pattern">pattern<a class="anchor" aria-label="anchor" href="#arg-pattern"></a></dt>
<dd><p>Used to filter Holidays (e.g. <code>pattern = "Easter"</code>). A "regular expression" filtering pattern.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p><strong>Converters</strong> - Date or date-time object the length of x</p></li>
<li><p><strong>Extractors</strong> - Returns information from a time-stamp.</p></li>
<li><p><strong>Current Time</strong> - Returns the current date/date-time based on your locale.</p></li>
<li><p><strong>Date Math</strong> - Numeric values or Date Values depending on the calculation.</p></li>
<li><p><strong>Date Sequences</strong> - Return a vector of dates or a Holiday Table (<code>tibble</code>).</p></li>
<li><p><strong>Date Collapsers</strong> - Date or date-time object the length of x</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Converters</strong> - Make date and date-time from text (character data)</p><ul><li><p>General String-to-Date Conversion: <code>AS_DATE()</code>, <code>AS_DATETIME()</code></p></li>
<li><p>Format-Specific String-to-Date Conversion: <code>YMD()</code> (YYYY-MM-DD), <code>MDY()</code> (MM-DD-YYYY), <code>DMY()</code> (DD-MM-YYYY)</p></li>
<li><p>Hour-Minute-Second Conversion: <code>YMD_HMS()</code>, <code>YMD_HM()</code>, and friends.</p></li>
</ul><p><strong>Extractors</strong> - Returns information from a time-stamp.</p><ul><li><p>Extractors: <code>SECOND()</code>, <code>MINUTE()</code>, <code>HOUR()</code>, <code>DAY()</code>, <code>WEEK()</code>, <code>MONTH()</code>, <code>QUARTER()</code>, <code>YEAR()</code></p></li>
</ul><p><strong>Current Time</strong> - Returns the current date/date-time based on your locale.</p><ul><li><p><code>NOW()</code>, <code>TODAY()</code></p></li>
</ul><p><strong>Date Math</strong> - Perform popular Excel date calculations</p><ul><li><p><code>EOMONTH()</code> - End of Month</p></li>
<li><p><code>NET_WORKDAYS()</code>, <code>COUNT_DAYS()</code> - Return number of days between 2 dates factoring in working days and holidays</p></li>
<li><p><code>YEARFRAC()</code> - Return the fractional period of the year that has been completed between 2 dates.</p></li>
</ul><p><strong>Date Sequences</strong> - Return a vector of dates or a Holiday Table (<code>tibble</code>).</p><ul><li><p><code>DATE_SEQUENCE()</code>, <code>WORKDAY_SEQUENCE()</code>, HOLIDAY_SEQUENCE - Return a sequence of dates between 2 dates that
factor in workdays and <code>timeDate</code> holiday calendars for popular business calendars including NYSE and London stock exchange.</p></li>
</ul><p><strong>Date Collapsers</strong> - Collapse a date sequence (useful in <code><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">dplyr::group_by()</a></code> and <code><a href="excel_pivot_table.html">pivot_table()</a></code>)</p><ul><li><p><code>FLOOR_DATE()</code>, <code>FLOOR_DAY()</code>, <code>FLOOR_WEEK()</code>, <code>FLOOR_MONTH()</code>, <code>FLOOR_QUARTER()</code>, <code>FLOOR_YEAR()</code></p></li>
<li><p>Similar functions exist for CEILING and ROUND. These are wrappers for <code>lubridate</code> functions.</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Libraries</span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://lubridate.tidyverse.org" class="external-link">lubridate</a></span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> Attaching package: ‘lubridate’</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> The following objects are masked from ‘package:base’:</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span>     date, intersect, setdiff, union</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Basic Usage ----</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Converters ---</span></span></span>
<span class="r-in"><span><span class="fu">AS_DATE</span><span class="op">(</span><span class="st">"2011 Jan-01"</span><span class="op">)</span> <span class="co"># General</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2011-01-01"</span>
<span class="r-in"><span><span class="fu">YMD</span><span class="op">(</span><span class="st">"2011 Jan-01"</span><span class="op">)</span>     <span class="co"># Year, Month-Day Format</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2011-01-01"</span>
<span class="r-in"><span><span class="fu">MDY</span><span class="op">(</span><span class="st">"01-02-20"</span><span class="op">)</span>        <span class="co"># Month-Day, Year Format (January 2nd, 2020)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-01-02"</span>
<span class="r-in"><span><span class="fu">DMY</span><span class="op">(</span><span class="st">"01-02-20"</span><span class="op">)</span>        <span class="co"># Day-Month, Year Format (February 1st, 2020)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-02-01"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extractors ---</span></span></span>
<span class="r-in"><span><span class="fu">WEEKDAY</span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span>                                  <span class="co"># Labelled Day</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-in"><span><span class="fu">WEEKDAY</span><span class="op">(</span><span class="st">"2020-01-01"</span>, label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>                   <span class="co"># Numeric Day</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 4</span>
<span class="r-in"><span><span class="fu">WEEKDAY</span><span class="op">(</span><span class="st">"2020-01-01"</span>, label <span class="op">=</span> <span class="cn">FALSE</span>, week_start <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>   <span class="co"># Start at 1 (Monday) vs 7 (Sunday)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 3</span>
<span class="r-in"><span><span class="fu">MONTH</span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="fu">QUARTER</span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1</span>
<span class="r-in"><span><span class="fu">YEAR</span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2020</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Current Date-Time ---</span></span></span>
<span class="r-in"><span><span class="fu">NOW</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2024-11-01 00:14:25 UTC"</span>
<span class="r-in"><span><span class="fu">TODAY</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2024-11-01"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Date Math ---</span></span></span>
<span class="r-in"><span><span class="fu">EOMONTH</span><span class="op">(</span><span class="st">"2020-01-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-01-31"</span>
<span class="r-in"><span><span class="fu">EOMONTH</span><span class="op">(</span><span class="st">"2020-01-01"</span>, months <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-02-29"</span>
<span class="r-in"><span><span class="fu">NET_WORKDAYS</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span><span class="op">)</span> <span class="co"># 131 Skipping Weekends</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 131</span>
<span class="r-in"><span><span class="fu">NET_WORKDAYS</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span>,</span></span>
<span class="r-in"><span>             holidays <span class="op">=</span> <span class="fu">HOLIDAY_SEQUENCE</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span>,</span></span>
<span class="r-in"><span>                                         calendar <span class="op">=</span> <span class="st">"NYSE"</span><span class="op">)</span><span class="op">)</span> <span class="co"># 126 Skipping 5 NYSE Holidays</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 126</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Date Sequences ---</span></span></span>
<span class="r-in"><span><span class="fu">DATE_SEQUENCE</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] "2020-01-01" "2020-01-02" "2020-01-03" "2020-01-04" "2020-01-05"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6] "2020-01-06" "2020-01-07" "2020-01-08" "2020-01-09" "2020-01-10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [11] "2020-01-11" "2020-01-12" "2020-01-13" "2020-01-14" "2020-01-15"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [16] "2020-01-16" "2020-01-17" "2020-01-18" "2020-01-19" "2020-01-20"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [21] "2020-01-21" "2020-01-22" "2020-01-23" "2020-01-24" "2020-01-25"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [26] "2020-01-26" "2020-01-27" "2020-01-28" "2020-01-29" "2020-01-30"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] "2020-01-31" "2020-02-01" "2020-02-02" "2020-02-03" "2020-02-04"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] "2020-02-05" "2020-02-06" "2020-02-07" "2020-02-08" "2020-02-09"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] "2020-02-10" "2020-02-11" "2020-02-12" "2020-02-13" "2020-02-14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [46] "2020-02-15" "2020-02-16" "2020-02-17" "2020-02-18" "2020-02-19"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [51] "2020-02-20" "2020-02-21" "2020-02-22" "2020-02-23" "2020-02-24"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [56] "2020-02-25" "2020-02-26" "2020-02-27" "2020-02-28" "2020-02-29"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] "2020-03-01" "2020-03-02" "2020-03-03" "2020-03-04" "2020-03-05"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [66] "2020-03-06" "2020-03-07" "2020-03-08" "2020-03-09" "2020-03-10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-14" "2020-03-15"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [76] "2020-03-16" "2020-03-17" "2020-03-18" "2020-03-19" "2020-03-20"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] "2020-03-21" "2020-03-22" "2020-03-23" "2020-03-24" "2020-03-25"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [86] "2020-03-26" "2020-03-27" "2020-03-28" "2020-03-29" "2020-03-30"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] "2020-03-31" "2020-04-01" "2020-04-02" "2020-04-03" "2020-04-04"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [96] "2020-04-05" "2020-04-06" "2020-04-07" "2020-04-08" "2020-04-09"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [101] "2020-04-10" "2020-04-11" "2020-04-12" "2020-04-13" "2020-04-14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [106] "2020-04-15" "2020-04-16" "2020-04-17" "2020-04-18" "2020-04-19"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [111] "2020-04-20" "2020-04-21" "2020-04-22" "2020-04-23" "2020-04-24"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [116] "2020-04-25" "2020-04-26" "2020-04-27" "2020-04-28" "2020-04-29"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121] "2020-04-30" "2020-05-01" "2020-05-02" "2020-05-03" "2020-05-04"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [126] "2020-05-05" "2020-05-06" "2020-05-07" "2020-05-08" "2020-05-09"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [131] "2020-05-10" "2020-05-11" "2020-05-12" "2020-05-13" "2020-05-14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [136] "2020-05-15" "2020-05-16" "2020-05-17" "2020-05-18" "2020-05-19"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [141] "2020-05-20" "2020-05-21" "2020-05-22" "2020-05-23" "2020-05-24"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [146] "2020-05-25" "2020-05-26" "2020-05-27" "2020-05-28" "2020-05-29"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [151] "2020-05-30" "2020-05-31" "2020-06-01" "2020-06-02" "2020-06-03"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [156] "2020-06-04" "2020-06-05" "2020-06-06" "2020-06-07" "2020-06-08"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [161] "2020-06-09" "2020-06-10" "2020-06-11" "2020-06-12" "2020-06-13"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [166] "2020-06-14" "2020-06-15" "2020-06-16" "2020-06-17" "2020-06-18"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [171] "2020-06-19" "2020-06-20" "2020-06-21" "2020-06-22" "2020-06-23"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [176] "2020-06-24" "2020-06-25" "2020-06-26" "2020-06-27" "2020-06-28"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [181] "2020-06-29" "2020-06-30" "2020-07-01"</span>
<span class="r-in"><span><span class="fu">WORKDAY_SEQUENCE</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] "2020-01-01" "2020-01-02" "2020-01-03" "2020-01-06" "2020-01-07"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6] "2020-01-08" "2020-01-09" "2020-01-10" "2020-01-13" "2020-01-14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [11] "2020-01-15" "2020-01-16" "2020-01-17" "2020-01-20" "2020-01-21"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [16] "2020-01-22" "2020-01-23" "2020-01-24" "2020-01-27" "2020-01-28"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [21] "2020-01-29" "2020-01-30" "2020-01-31" "2020-02-03" "2020-02-04"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [26] "2020-02-05" "2020-02-06" "2020-02-07" "2020-02-10" "2020-02-11"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] "2020-02-12" "2020-02-13" "2020-02-14" "2020-02-17" "2020-02-18"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] "2020-02-19" "2020-02-20" "2020-02-21" "2020-02-24" "2020-02-25"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] "2020-02-26" "2020-02-27" "2020-02-28" "2020-03-02" "2020-03-03"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [46] "2020-03-04" "2020-03-05" "2020-03-06" "2020-03-09" "2020-03-10"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [51] "2020-03-11" "2020-03-12" "2020-03-13" "2020-03-16" "2020-03-17"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [56] "2020-03-18" "2020-03-19" "2020-03-20" "2020-03-23" "2020-03-24"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] "2020-03-25" "2020-03-26" "2020-03-27" "2020-03-30" "2020-03-31"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [66] "2020-04-01" "2020-04-02" "2020-04-03" "2020-04-06" "2020-04-07"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] "2020-04-08" "2020-04-09" "2020-04-10" "2020-04-13" "2020-04-14"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [76] "2020-04-15" "2020-04-16" "2020-04-17" "2020-04-20" "2020-04-21"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] "2020-04-22" "2020-04-23" "2020-04-24" "2020-04-27" "2020-04-28"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [86] "2020-04-29" "2020-04-30" "2020-05-01" "2020-05-04" "2020-05-05"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] "2020-05-06" "2020-05-07" "2020-05-08" "2020-05-11" "2020-05-12"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [96] "2020-05-13" "2020-05-14" "2020-05-15" "2020-05-18" "2020-05-19"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [101] "2020-05-20" "2020-05-21" "2020-05-22" "2020-05-25" "2020-05-26"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [106] "2020-05-27" "2020-05-28" "2020-05-29" "2020-06-01" "2020-06-02"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [111] "2020-06-03" "2020-06-04" "2020-06-05" "2020-06-08" "2020-06-09"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [116] "2020-06-10" "2020-06-11" "2020-06-12" "2020-06-15" "2020-06-16"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121] "2020-06-17" "2020-06-18" "2020-06-19" "2020-06-22" "2020-06-23"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [126] "2020-06-24" "2020-06-25" "2020-06-26" "2020-06-29" "2020-06-30"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [131] "2020-07-01"</span>
<span class="r-in"><span><span class="fu">HOLIDAY_SEQUENCE</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span>, calendar <span class="op">=</span> <span class="st">"NYSE"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-01-01" "2020-01-20" "2020-02-17" "2020-04-10" "2020-05-25"</span>
<span class="r-in"><span><span class="fu">WORKDAY_SEQUENCE</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span>,</span></span>
<span class="r-in"><span>                 holidays <span class="op">=</span> <span class="fu">HOLIDAY_SEQUENCE</span><span class="op">(</span><span class="st">"2020-01-01"</span>, <span class="st">"2020-07-01"</span>,</span></span>
<span class="r-in"><span>                                             calendar <span class="op">=</span> <span class="st">"NYSE"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [1] "2020-01-02" "2020-01-03" "2020-01-06" "2020-01-07" "2020-01-08"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   [6] "2020-01-09" "2020-01-10" "2020-01-13" "2020-01-14" "2020-01-15"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [11] "2020-01-16" "2020-01-17" "2020-01-21" "2020-01-22" "2020-01-23"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [16] "2020-01-24" "2020-01-27" "2020-01-28" "2020-01-29" "2020-01-30"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [21] "2020-01-31" "2020-02-03" "2020-02-04" "2020-02-05" "2020-02-06"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [26] "2020-02-07" "2020-02-10" "2020-02-11" "2020-02-12" "2020-02-13"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [31] "2020-02-14" "2020-02-18" "2020-02-19" "2020-02-20" "2020-02-21"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [36] "2020-02-24" "2020-02-25" "2020-02-26" "2020-02-27" "2020-02-28"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [41] "2020-03-02" "2020-03-03" "2020-03-04" "2020-03-05" "2020-03-06"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [46] "2020-03-09" "2020-03-10" "2020-03-11" "2020-03-12" "2020-03-13"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [51] "2020-03-16" "2020-03-17" "2020-03-18" "2020-03-19" "2020-03-20"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [56] "2020-03-23" "2020-03-24" "2020-03-25" "2020-03-26" "2020-03-27"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [61] "2020-03-30" "2020-03-31" "2020-04-01" "2020-04-02" "2020-04-03"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [66] "2020-04-06" "2020-04-07" "2020-04-08" "2020-04-09" "2020-04-13"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [71] "2020-04-14" "2020-04-15" "2020-04-16" "2020-04-17" "2020-04-20"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [76] "2020-04-21" "2020-04-22" "2020-04-23" "2020-04-24" "2020-04-27"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [81] "2020-04-28" "2020-04-29" "2020-04-30" "2020-05-01" "2020-05-04"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [86] "2020-05-05" "2020-05-06" "2020-05-07" "2020-05-08" "2020-05-11"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [91] "2020-05-12" "2020-05-13" "2020-05-14" "2020-05-15" "2020-05-18"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [96] "2020-05-19" "2020-05-20" "2020-05-21" "2020-05-22" "2020-05-26"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [101] "2020-05-27" "2020-05-28" "2020-05-29" "2020-06-01" "2020-06-02"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [106] "2020-06-03" "2020-06-04" "2020-06-05" "2020-06-08" "2020-06-09"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [111] "2020-06-10" "2020-06-11" "2020-06-12" "2020-06-15" "2020-06-16"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [116] "2020-06-17" "2020-06-18" "2020-06-19" "2020-06-22" "2020-06-23"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [121] "2020-06-24" "2020-06-25" "2020-06-26" "2020-06-29" "2020-06-30"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [126] "2020-07-01"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Date Collapsers ---</span></span></span>
<span class="r-in"><span><span class="fu">FLOOR_DATE</span><span class="op">(</span><span class="fu">AS_DATE</span><span class="op">(</span><span class="st">"2020-01-15"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-01-01"</span>
<span class="r-in"><span><span class="fu">CEILING_DATE</span><span class="op">(</span><span class="fu">AS_DATE</span><span class="op">(</span><span class="st">"2020-01-15"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-02-01"</span>
<span class="r-in"><span><span class="fu">CEILING_DATE</span><span class="op">(</span><span class="fu">AS_DATE</span><span class="op">(</span><span class="st">"2020-01-15"</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"month"</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://lubridate.tidyverse.org/reference/duration.html" class="external-link">ddays</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="co"># EOMONTH using lubridate</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "2020-01-31"</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># --- Usage with tidyverse ---</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Calculate returns by symbol/year/quarter</span></span></span>
<span class="r-in"><span><span class="va">FANG</span> <span class="op"><a href="pipe.html">%&gt;%</a></span></span></span>
<span class="r-in"><span>    <span class="fu"><a href="excel_pivot_table.html">pivot_table</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>        .rows       <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">symbol</span>, <span class="op">~</span> <span class="fu">QUARTER</span><span class="op">(</span><span class="va">date</span><span class="op">)</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        .columns    <span class="op">=</span> <span class="op">~</span> <span class="fu">YEAR</span><span class="op">(</span><span class="va">date</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>        .values     <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="excel_stat_summary_functions.html">PCT_CHANGE_FIRSTLAST</a></span><span class="op">(</span><span class="va">adjusted</span><span class="op">)</span></span></span>
<span class="r-in"><span>    <span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 16 × 6</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    symbol `QUARTER(date)`  `2013`   `2014`  `2015`    `2016`</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> AMZN                 1  0.035<span style="text-decoration: underline;">7</span> -<span style="color: #BB0000;">0.155</span>    0.206  -<span style="color: #BB0000;">0.068</span><span style="color: #BB0000; text-decoration: underline;">1</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> AMZN                 2  0.061<span style="text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.053</span><span style="color: #BB0000; text-decoration: underline;">1</span>   0.172   0.196   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> AMZN                 3  0.108  -<span style="color: #BB0000;">0.029</span><span style="color: #BB0000; text-decoration: underline;">9</span>   0.170   0.154   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> AMZN                 4  0.243  -<span style="color: #BB0000;">0.022</span><span style="color: #BB0000; text-decoration: underline;">4</span>   0.298  -<span style="color: #BB0000;">0.104</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> GOOG                 1  0.098<span style="text-decoration: underline;">1</span>  0.001<span style="text-decoration: underline;">74</span>  0.044<span style="text-decoration: underline;">2</span>  0.004<span style="text-decoration: underline;">19</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> GOOG                 2  0.098<span style="text-decoration: underline;">8</span>  0.014<span style="text-decoration: underline;">3</span>  -<span style="color: #BB0000;">0.040</span><span style="color: #BB0000; text-decoration: underline;">6</span> -<span style="color: #BB0000;">0.077</span><span style="color: #BB0000; text-decoration: underline;">1</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> GOOG                 3 -<span style="color: #BB0000;">0.013</span><span style="color: #BB0000; text-decoration: underline;">5</span> -<span style="color: #BB0000;">0.009</span><span style="color: #BB0000; text-decoration: underline;">11</span>  0.166   0.112   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> GOOG                 4  0.263  -<span style="color: #BB0000;">0.073</span><span style="color: #BB0000; text-decoration: underline;">7</span>   0.241  -<span style="color: #BB0000;">0.000</span><span style="color: #BB0000; text-decoration: underline;">958</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> META                 1 -<span style="color: #BB0000;">0.086</span><span style="color: #BB0000; text-decoration: underline;">4</span>  0.101    0.048<span style="text-decoration: underline;">1</span>  0.116   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> META                 2 -<span style="color: #BB0000;">0.025</span><span style="color: #BB0000; text-decoration: underline;">5</span>  0.074<span style="text-decoration: underline;">6</span>   0.050<span style="text-decoration: underline;">2</span> -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">3</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">11</span> META                 3  1.02    0.161    0.034<span style="text-decoration: underline;">4</span>  0.123   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">12</span> META                 4  0.083<span style="text-decoration: underline;">9</span>  0.019<span style="text-decoration: underline;">2</span>   0.151  -<span style="color: #BB0000;">0.107</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">13</span> NFLX                 1  1.06   -<span style="color: #BB0000;">0.029</span><span style="color: #BB0000; text-decoration: underline;">7</span>   0.194  -<span style="color: #BB0000;">0.070</span><span style="color: #BB0000; text-decoration: underline;">3</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">14</span> NFLX                 2  0.157   0.208    0.590  -<span style="color: #BB0000;">0.135</span>   </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">15</span> NFLX                 3  0.379  -<span style="color: #BB0000;">0.046</span><span style="color: #BB0000; text-decoration: underline;">3</span>   0.103   0.019<span style="text-decoration: underline;">4</span>  </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">16</span> NFLX                 4  0.134  -<span style="color: #BB0000;">0.221</span>    0.079<span style="text-decoration: underline;">3</span>  0.206   </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Dancho, Davis Vaughan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>


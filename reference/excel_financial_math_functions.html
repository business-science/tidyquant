<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Excel Financial Math Functions — excel_financial_math_functions • tidyquant</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Excel Financial Math Functions — excel_financial_math_functions"><meta property="og:description" content="Excel financial math functions are designed to easily calculate Net Present Value (NPV()),
Future Value of cashflow (FV()), Present Value of future cashflow (PV()), and more.
These functions are designed to help users coming from an Excel background.
Most functions replicate the behavior of Excel:
Names are similar to Excel function names
By default, missing values are ignored (same as in Excel)

"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-2');
</script></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidyquant</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../reference/index.html">Function Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Tutorials
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu"><li>
      <a href="../articles/TQ06-excel-in-r.html">NEW: Excel in R</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Financial Workflow</li>
    <li>
      <a href="../articles/TQ00-introduction-to-tidyquant.html">Introduction to tidyquant</a>
    </li>
    <li>
      <a href="../articles/TQ01-core-functions-in-tidyquant.html">Core functions</a>
    </li>
    <li>
      <a href="../articles/TQ02-quant-integrations-in-tidyquant.html">Quantitative integrations</a>
    </li>
    <li>
      <a href="../articles/TQ03-scaling-and-modeling-with-tidyquant.html">Scaling and modeling</a>
    </li>
    <li>
      <a href="../articles/TQ04-charting-with-tidyquant.html">Charting</a>
    </li>
    <li>
      <a href="../articles/TQ05-performance-analysis-with-tidyquant.html">Performance analysis</a>
    </li>
  </ul></li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/business-science/tidyquant" class="external-link">
    <span class="fab fa-github"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Excel Financial Math Functions</h1>
    <small class="dont-index">Source: <a href="https://github.com/business-science/tidyquant/blob/HEAD/R/excel-financial-math-functions.R" class="external-link"><code>R/excel-financial-math-functions.R</code></a></small>
    <div class="hidden name"><code>excel_financial_math_functions.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><strong>Excel financial math functions</strong> are designed to easily calculate Net Present Value (<code>NPV()</code>),
Future Value of cashflow (<code>FV()</code>), Present Value of future cashflow (<code>PV()</code>), and more.</p>
<p>These functions are designed to help users coming from an <strong>Excel background</strong>.
Most functions replicate the behavior of Excel:</p><ul><li><p>Names are similar to Excel function names</p></li>
<li><p>By default, missing values are ignored (same as in Excel)</p></li>
</ul></div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">NPV</span><span class="op">(</span><span class="va">cashflow</span>, <span class="va">rate</span>, nper <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span>

<span class="fu">IRR</span><span class="op">(</span><span class="va">cashflow</span><span class="op">)</span>

<span class="fu">FV</span><span class="op">(</span><span class="va">rate</span>, <span class="va">nper</span>, pv <span class="op">=</span> <span class="fl">0</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu">PV</span><span class="op">(</span><span class="va">rate</span>, <span class="va">nper</span>, fv <span class="op">=</span> <span class="fl">0</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu">PMT</span><span class="op">(</span><span class="va">rate</span>, <span class="va">nper</span>, <span class="va">pv</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu">RATE</span><span class="op">(</span><span class="va">nper</span>, <span class="va">pmt</span>, <span class="va">pv</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>cashflow</dt>
<dd><p>Cash flow values. When one value is provided, it's assumed constant cash flow.</p></dd>
<dt>rate</dt>
<dd><p>One or more rate. When one rate is provided it's assumed constant rate.</p></dd>
<dt>nper</dt>
<dd><p>Number of periods. When `nper`` is provided, the cashflow values and rate are assumed constant.</p></dd>
<dt>pv</dt>
<dd><p>Present value. Initial investments (cash inflows) are typcially a negative value.</p></dd>
<dt>pmt</dt>
<dd><p>Number of payments per period.</p></dd>
<dt>type</dt>
<dd><p>Should payments (<code>pmt</code>) occur at the beginning (<code>type = 0</code>) or
the end (<code>type = 1</code>) of each period.</p></dd>
<dt>fv</dt>
<dd><p>Future value. Cash outflows are typically a positive value.</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <ul><li><p>Summary functions return a single value</p></li>
</ul></div>
    <div id="details">
    <h2>Details</h2>
    <p><strong>Net Present Value (NPV)</strong>
Net present value (NPV) is the difference between the present value of cash inflows and
the present value of cash outflows over a period of time. NPV is used in capital budgeting
and investment planning to analyze the profitability of a projected investment or project.
For more information, see <a href="https://www.investopedia.com/terms/n/npv.asp" class="external-link">Investopedia NPV</a>.</p>
<p><strong>Internal Rate of Return (IRR)</strong>
The internal rate of return (IRR) is a metric used in capital budgeting to estimate the
profitability of potential investments. The internal rate of return is a discount rate
that makes the net present value (NPV) of all cash flows from a particular project equal
to zero. IRR calculations rely on the same formula as NPV does.
For more information, see <a href="https://www.investopedia.com/terms/i/irr.asp" class="external-link">Investopedia IRR</a>.</p>
<p><strong>Future Value (FV)</strong>
Future value (FV) is the value of a current asset at a future date based on an assumed
rate of growth. The future value (FV) is important to investors and financial planners
as they use it to estimate how much an investment made today will be worth in the future.
Knowing the future value enables investors to make sound investment decisions based on
their anticipated needs. However, external economic factors, such as inflation, can adversely
affect the future value of the asset by eroding its value.
For more information, see <a href="https://www.investopedia.com/terms/f/futurevalue.asp" class="external-link">Investopedia FV</a>.</p>
<p><strong>Present Value (PV)</strong>
Present value (PV) is the current value of a future sum of money or stream of cash flows given a
specified rate of return. Future cash flows are discounted at the discount rate, and the higher
the discount rate, the lower the present value of the future cash flows. Determining the
appropriate discount rate is the key to properly valuing future cash flows, whether they be earnings
or obligations. For more information, see <a href="https://www.investopedia.com/terms/p/presentvalue.asp" class="external-link">Investopedia PV</a>.</p>
<p><strong>Payment (PMT)</strong>
The Payment <code>PMT()</code> function calculates the payment for a loan based on constant payments and a constant interest rate.</p>
<p><strong>Rate (RATE)</strong>
Returns the interest rate per period of a loan or an investment.
For example, use 6%/4 for quarterly payments at 6% APR.</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"></span>
<span class="r-in"><span class="fu">NPV</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">250</span>, <span class="fl">350</span>, <span class="fl">450</span>, <span class="fl">450</span><span class="op">)</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 314.4986</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">IRR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">250</span>, <span class="fl">350</span>, <span class="fl">450</span>, <span class="fl">450</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1656206</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">FV</span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.05</span>, nper <span class="op">=</span> <span class="fl">5</span>, pv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 127.6282</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">PV</span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.05</span>, nper <span class="op">=</span> <span class="fl">5</span>, fv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 78.35262</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">PMT</span><span class="op">(</span>nper <span class="op">=</span> <span class="fl">20</span>, rate <span class="op">=</span> <span class="fl">0.05</span>, pv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.024259</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">RATE</span><span class="op">(</span>nper <span class="op">=</span> <span class="fl">20</span>, pmt <span class="op">=</span> <span class="fl">8</span>, pv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04964019</span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Matt Dancho, Davis Vaughan.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.3.</p>
</div>

      </footer></div>

  


  

  </body></html>


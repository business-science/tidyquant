<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Excel Financial Math Functions — excel_financial_math_functions • tidyquant</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Excel Financial Math Functions — excel_financial_math_functions"><meta name="description" content="Excel financial math functions are designed to easily calculate Net Present Value (NPV()),
Future Value of cashflow (FV()), Present Value of future cashflow (PV()), and more.
These functions are designed to help users coming from an Excel background.
Most functions replicate the behavior of Excel:
Names are similar to Excel function names
By default, missing values are ignored (same as in Excel)

"><meta property="og:description" content="Excel financial math functions are designed to easily calculate Net Present Value (NPV()),
Future Value of cashflow (FV()), Present Value of future cashflow (PV()), and more.
These functions are designed to help users coming from an Excel background.
Most functions replicate the behavior of Excel:
Names are similar to Excel function names
By default, missing values are ignored (same as in Excel)

"><meta property="og:image" content="https://business-science.github.io/tidyquant/logo.png"><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-76139189-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-76139189-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyquant</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.7.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/TQ00-introduction-to-tidyquant.html">Start</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Financial Workflow</h6></li>
    <li><a class="dropdown-item" href="../articles/TQ00-introduction-to-tidyquant.html">Introduction to tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ01-core-functions-in-tidyquant.html">Core Functions in tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ02-quant-integrations-in-tidyquant.html">R Quantitative Analysis Package Integrations in tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ03-scaling-and-modeling-with-tidyquant.html">Scaling and Modeling with tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ04-charting-with-tidyquant.html">Charting with tidyquant</a></li>
    <li><a class="dropdown-item" href="../articles/TQ05-performance-analysis-with-tidyquant.html">Performance Analysis with tidyquant</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Excel Users</h6></li>
    <li><a class="dropdown-item" href="../articles/TQ06-excel-in-r.html">Excel in R with tidyquant</a></li>
  </ul></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">News</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/business-science/tidyquant/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Excel Financial Math Functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/business-science/tidyquant/blob/master/R/excel-financial-math-functions.R" class="external-link"><code>R/excel-financial-math-functions.R</code></a></small>
      <div class="d-none name"><code>excel_financial_math_functions.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><strong>Excel financial math functions</strong> are designed to easily calculate Net Present Value (<code>NPV()</code>),
Future Value of cashflow (<code>FV()</code>), Present Value of future cashflow (<code>PV()</code>), and more.</p>
<p>These functions are designed to help users coming from an <strong>Excel background</strong>.
Most functions replicate the behavior of Excel:</p><ul><li><p>Names are similar to Excel function names</p></li>
<li><p>By default, missing values are ignored (same as in Excel)</p></li>
</ul></div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">NPV</span><span class="op">(</span><span class="va">cashflow</span>, <span class="va">rate</span>, nper <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">IRR</span><span class="op">(</span><span class="va">cashflow</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">FV</span><span class="op">(</span><span class="va">rate</span>, <span class="va">nper</span>, pv <span class="op">=</span> <span class="fl">0</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">PV</span><span class="op">(</span><span class="va">rate</span>, <span class="va">nper</span>, fv <span class="op">=</span> <span class="fl">0</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">PMT</span><span class="op">(</span><span class="va">rate</span>, <span class="va">nper</span>, <span class="va">pv</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">RATE</span><span class="op">(</span><span class="va">nper</span>, <span class="va">pmt</span>, <span class="va">pv</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-cashflow">cashflow<a class="anchor" aria-label="anchor" href="#arg-cashflow"></a></dt>
<dd><p>Cash flow values. When one value is provided, it's assumed constant cash flow.</p></dd>


<dt id="arg-rate">rate<a class="anchor" aria-label="anchor" href="#arg-rate"></a></dt>
<dd><p>One or more rate. When one rate is provided it's assumed constant rate.</p></dd>


<dt id="arg-nper">nper<a class="anchor" aria-label="anchor" href="#arg-nper"></a></dt>
<dd><p>Number of periods. When `nper“ is provided, the cashflow values and rate are assumed constant.</p></dd>


<dt id="arg-pv">pv<a class="anchor" aria-label="anchor" href="#arg-pv"></a></dt>
<dd><p>Present value. Initial investments (cash inflows) are typically a negative value.</p></dd>


<dt id="arg-pmt">pmt<a class="anchor" aria-label="anchor" href="#arg-pmt"></a></dt>
<dd><p>Number of payments per period.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>Should payments (<code>pmt</code>) occur at the beginning (<code>type = 0</code>) or
the end (<code>type = 1</code>) of each period.</p></dd>


<dt id="arg-fv">fv<a class="anchor" aria-label="anchor" href="#arg-fv"></a></dt>
<dd><p>Future value. Cash outflows are typically a positive value.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>

<ul><li><p>Summary functions return a single value</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p><strong>Net Present Value (NPV)</strong>
Net present value (NPV) is the difference between the present value of cash inflows and
the present value of cash outflows over a period of time. NPV is used in capital budgeting
and investment planning to analyze the profitability of a projected investment or project.
For more information, see <a href="https://www.investopedia.com/terms/n/npv.asp" class="external-link">Investopedia NPV</a>.</p>
<p><strong>Internal Rate of Return (IRR)</strong>
The internal rate of return (IRR) is a metric used in capital budgeting to estimate the
profitability of potential investments. The internal rate of return is a discount rate
that makes the net present value (NPV) of all cash flows from a particular project equal
to zero. IRR calculations rely on the same formula as NPV does.
For more information, see <a href="https://www.investopedia.com/terms/i/irr.asp" class="external-link">Investopedia IRR</a>.</p>
<p><strong>Future Value (FV)</strong>
Future value (FV) is the value of a current asset at a future date based on an assumed
rate of growth. The future value (FV) is important to investors and financial planners
as they use it to estimate how much an investment made today will be worth in the future.
Knowing the future value enables investors to make sound investment decisions based on
their anticipated needs. However, external economic factors, such as inflation, can adversely
affect the future value of the asset by eroding its value.
For more information, see <a href="https://www.investopedia.com/terms/f/futurevalue.asp" class="external-link">Investopedia FV</a>.</p>
<p><strong>Present Value (PV)</strong>
Present value (PV) is the current value of a future sum of money or stream of cash flows given a
specified rate of return. Future cash flows are discounted at the discount rate, and the higher
the discount rate, the lower the present value of the future cash flows. Determining the
appropriate discount rate is the key to properly valuing future cash flows, whether they be earnings
or obligations. For more information, see <a href="https://www.investopedia.com/terms/p/presentvalue.asp" class="external-link">Investopedia PV</a>.</p>
<p><strong>Payment (PMT)</strong>
The Payment <code>PMT()</code> function calculates the payment for a loan based on constant payments and a constant interest rate.</p>
<p><strong>Rate (RATE)</strong>
Returns the interest rate per period of a loan or an investment.
For example, use 6%/4 for quarterly payments at 6% APR.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">NPV</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">250</span>, <span class="fl">350</span>, <span class="fl">450</span>, <span class="fl">450</span><span class="op">)</span>, rate <span class="op">=</span> <span class="fl">0.05</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 314.4986</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">IRR</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1000</span>, <span class="fl">250</span>, <span class="fl">350</span>, <span class="fl">450</span>, <span class="fl">450</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1656206</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FV</span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.05</span>, nper <span class="op">=</span> <span class="fl">5</span>, pv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 127.6282</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">PV</span><span class="op">(</span>rate <span class="op">=</span> <span class="fl">0.05</span>, nper <span class="op">=</span> <span class="fl">5</span>, fv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, pmt <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 78.35262</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">PMT</span><span class="op">(</span>nper <span class="op">=</span> <span class="fl">20</span>, rate <span class="op">=</span> <span class="fl">0.05</span>, pv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 8.024259</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">RATE</span><span class="op">(</span>nper <span class="op">=</span> <span class="fl">20</span>, pmt <span class="op">=</span> <span class="fl">8</span>, pv <span class="op">=</span> <span class="op">-</span><span class="fl">100</span>, fv <span class="op">=</span> <span class="fl">0</span>, type <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.04964019</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Matt Dancho, Davis Vaughan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer></div>





  </body></html>

